package com.adiro.nasm_ide.logic;

import java.io.BufferedReader;
import java.io.File;
import java.io.*;
import java.io.FileReader;
import java.io.IOException;
import java.nio.file.Files;
import java.nio.file.Paths;

public final class DebugFileCreator {
		
		public static void createDebugFile(String sourceFilePath) {
			var outputContent = "";
			var debugFilePath = getFileDirectory(sourceFilePath) + "/runDebug.asm";
			
			BufferedReader reader;
			try {
				new File(sourceFilePath).createNewFile();
				reader = new BufferedReader(new FileReader(sourceFilePath));
				
				
				
				String line = reader.readLine();
				int i = 0;
				while(line != null) {
					
					debugFilePath += 
							  line	+ "\n"
							+ ";<DEBUG>\n"
							+ String.format("mov	[dane], byte {0}", (i >> 8)) + "\n"
							+ String.format("mov	[dane+1], byte {0}", (i & 0x00FF)) + "\n"
							+ "call 	zapLinie\n"	
							+ ";</DEBUG>\n";
					line = reader.readLine();
					i++;
				}
				
				reader.close();
			}
			catch(IOException e) {
				System.out.print("[FileCreator ERROR] couldn't find: " + sourceFilePath);
			}
			
			
			try {
				var writer = new BufferedWriter(new FileWriter(debugFilePath));
				writer.write(outputContent);
				writer.close();
			} catch (IOException e) {
				System.out.print("[FileCreator ERROR] couldn't write to: " + debugFilePath);
			}
		}
		
			
			
		
		private static String getFileDirectory(String filePath) {
			File sourceFile = new File(filePath);
			return sourceFile.getParent();
		}
}
